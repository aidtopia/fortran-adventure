C   SCRATCH PROJECT TO CHECK OUT THE TRANSLATOR

      PROGRAM ADVTST

      IMPLICIT INTEGER(A-Z)
      EXTERNAL SAYIT,NOCALL
      DIMENSION D(2)
      DATA X/32/,W1/'HELLO'/,W2/'WORLD'/
      TYPE 55,W1,W2
55    FORMAT(' ',A5,', ',A5,'!')
      CALL DATE(D)
      CALL TIME(T)
      TYPE 66,D,T
66    FORMAT(' NOW: ',2A5, ' ', 2A5)
      RESULT = YEAR(D)
      TYPE 77,RESULT
77    FORMAT(' THE YEAR IS ', I4)
      GOTO 99
88    UNUSED='NOPE'
99    CALL FOO(BAR(X), SAYIT)
      STOP
      END


      SUBROUTINE FOO(X, SUB)

      IMPLICIT INTEGER(A-Z)

      CALL SUB(X)
      END


      FUNCTION BAR(X)

      IMPLICIT INTEGER(A-Z)

      BAR = X
      RETURN
      END
      

      SUBROUTINE NOCALL(X, Y, Z)

      IMPLICIT INTEGER(A-Z)
      
      TYPE 55,X,Y
55    FORMAT(' COORDINATE = (',I3,', ', I3,')')
      END

      SUBROUTINE SAYIT(X)

      IMPLICIT INTEGER(A-Z)

      TYPE 55,X
55    FORMAT(/' YOUR NUMBER IS: ',I3)
      END


C   LIFTED FROM WOOD0350V1 ADVENTURE IN ORDER TO TEST MY HACK FOR Y2K BUGS.
	INTEGER FUNCTION DAYS(DAT)
	IMPLICIT INTEGER(A-Z)
	DIMENSION DAT(2),MONTHS(12),HATH(12)
	DATA MONTHS/'-JAN-','-FEB-','-MAR-','-APR-','-MAY-','-JUN-',
	1	'-JUL-','-AUG-','-SEP-','-OCT-','-NOV-','-DEC-'/
	DATA HATH/31,28,31,30,31,30,31,31,30,31,30,31/

C  FUNCTION I2 TAKES 2-DIGIT ASCII AND YIELDS DECIMAL VALUE.

	I2(X)=(SHIFT(X,-29).AND.15)*10+(SHIFT(X,-22).AND.15)

	YEAR=I2(SHIFT(DAT(2),14))-77
	D=I2(DAT(1))-1
	X=((SHIFT(DAT(1),14).OR.SHIFT(DAT(2),-21)).AND..NOT."1004020001)
	1	.OR.'-@@@-'
C  ABOVE FUNNY EXPRESSION GUARANTEES (A) UPPER-CASE, AND (B) BOTTOM BIT OKAY.
	DO 1 MON=1,12
	IF(X.EQ.MONTHS(MON))GOTO 2
1	D=D+HATH(MON)
	STOP

2	D=D+YEAR*365+YEAR/4
	IF(MOD(YEAR,4).EQ.3.AND.MON.GT.2)D=D+1
	DAYS=D
	RETURN
	END


C   LIFTED FROM WOOD0350V1 ADVENTURE IN ORDER TO TEST MY HACK FOR Y2K BUGS.
	INTEGER FUNCTION YEAR(DAT)
	IMPLICIT INTEGER(A-Z)
	DIMENSION DAT(2)
	I2(X)=(SHIFT(X,-29).AND.15)*10+(SHIFT(X,-22).AND.15)
	YEAR=I2(SHIFT(DAT(2),14))+1900
	RETURN
	END


	INTEGER FUNCTION SHIFT(VAL,DIST)
	IMPLICIT INTEGER(A-Z)

C  RETURN VAL LEFT-SHIFTED (LOGICALLY) DIST BITS (RIGHT-SHIFT IF DIST<0).

	SHIFT=VAL
	IF(DIST)10,20,30
10	IDIST=-DIST
	DO 11 I=1,IDIST
	J=0
	IF(SHIFT.LT.0)J="200000000000
11	SHIFT=((SHIFT.AND."377777777777)/2)+J
20	RETURN
30	DO 31 I=1,DIST
	J=0
	IF((SHIFT.AND."200000000000).NE.0)J="400000000000
31	SHIFT=(SHIFT.AND."177777777777)*2+J
	RETURN
	END
